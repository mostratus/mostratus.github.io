<html>
<head>
    <title>Loop CSV File uploader</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1 style="text-align: center;">Loop Neighborhood CSV file Uploader</h1>
    <p style="text-align: center;"><strong>Please click on each button to upload the corresponding CSV file</strong></p>

    <br><br>
    
    <div style="display: flex; justify-content: center;">
    
    <button class="btn btn-primary" data-csvbox disabled onclick="importer.openModal();" style="margin-right: 10px; height: 50px; width: 200px"><strong>Import Payroll CSV</strong></button>
    <button class="btn btn-primary" data-csvbox onclick="importer2.openModal();" style="margin-right: 10px; height: 50px; width: 200px"><strong>Import Fuel Price Report (Test)</strong></button>    
    <button class="btn btn-primary" data-csvbox onclick="importer3.openModal();" style="margin-right: 10px; height: 50px; width: 200px"><strong>test</strong></button>

    </div>
    <br><br>  

    <script type="text/javascript" src="https://js.csvbox.io/script.js"></script>
    <script type="text/javascript">
    var file_name;
    function callback(result, data) {
       if(result){
           console.log("Sheet uploaded successfully");
           console.log(data.row_success + " rows uploaded");
       }else{
           console.log("There was some problem uploading the sheet");
       }
        file_name = data.original_filename;
    }
    let importer = new CSVBoxImporter("LclAg9oaHmH6pXgDWNO6TzmoSPFwqu",{}, callback);
    importer.setUser({
        user_id: "Stratus",
        team_id: "Loop Neighborhood",
        email: "sanjit@loopneighborhood.com"
    })
    var dateObject = new Date();
    var year = dateObject.getFullYear();
    var month = dateObject.getMonth() + 1;
    var date = dateObject.getDate();
    importer.setOptions({
    target_file_name: "Labor Distribution Report for PD "  + month + "-" + date + "-" + year
    })
        
    let importer2 = new CSVBoxImporter("7vT2u9UQb8gJIBkGOGH3vBOMl15DrP",{}, callback);
    importer2.setUser({
        user_id: "Stratus",
        team_id: "Loop Neighborhood",
        email: "sanjit@loopneighborhood.com"
    })  
    importer2.setOptions({
    target_file_name: file_name
        //"audit "  + month + "-" + date + "-" + year
    })
        
    let importer3 = new CSVBoxImporter("PaR955BTLtBdVDKdBQBCkp1wLmPX7l",{}, callback);
    importer3.setUser({
        user_id: "Stratus",
        team_id: "Loop Neighborhood",
        email: "sanjit@loopneighborhood.com"
    })  
    importer3.setOptions({
    target_file_name: "Test "  + month + "-" + date + "-" + year
    })
</script>
    <div style="text-align: center;">
    <img src='https://www.loopneighborhood.com/wp-content/uploads/2022/09/Image-Mask-2.png' style="display: block; margin: 0 auto;">
    </div>
</body>

</html>
